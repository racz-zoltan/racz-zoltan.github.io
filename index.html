<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CarryPass</title>
  <link rel="shortcut icon" href="/static/favicon.ico">
  
  <link href="bootstrap.min.css" rel="stylesheet">
  <script src="jquery.min.js"></script>

  <link rel="stylesheet" href="keygen_styles.css">
  <script src="crypto-js.min.js"></script>

  <link rel="manifest" href="/manifest.json">

</head>
<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
    <a class="navbar-brand" href="#home">CarryPass</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="#keygen">Create Secure Password</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#encryption">Encrypt and Decrypt</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#pricing">Pricing</a>
        </li>
        <li class="nav-item">
            <a type="button" id="downloadButton" class="nav-link" href="">Download</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#contact">Contact</a>
          </li>
      </ul>
    </div>
  </nav>

<!-- First Section -->
<section id="home" class="first-section" style="background-image: url('leohoho-kXYExBLuZ9Q-unsplash.jpg');">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <h1 style="color: darkblue;">Password privacy</h1>
          <h1 style="color: darkblue; margin-left: 5rem;">peace of mind</h1>
          <a href="#keygen" style="margin-top: 9rem;" class="btn btn-outline-primary">Create</a>
        </div>
        <div class="col-md-6">
            <!-- Second column content goes here -->
        </div>
      </div>
    </div>
</section>

  <!-- Second Section -->
  <section id="keygen" class="second-section">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
                <!-- <h3 style="color: darkblue; margin-top: 3rem;">Create a Password</h3> -->
                
                <form id="keyGeneratorForm">
                  <div class="mb-3">
                    <label for="webAddress" class="form-label">Website name</label>
                    <input type="text" id="webAddress" name="webAddress" class="form-control" required>
                  </div>
                  
                  <div class="mb-3">
                    <label for="password" class="form-label">Master key</label>
                    <div class="input-group">
                    <input type="text" id="password" name="password" class="form-control" required>
                    <button id="showbutton" type="button" class="btn btn-outline-primary" onclick="showMaster()">Hide</button>
                    </div>
                  </div>
                  
                  <div class="mb-3">
                    <label for="length" class="form-label">Password length</label>
                    <input type="number" id="length" name="length" class="form-control" value="21" required>
                  </div>
                  <div class="mb-3">
                    <label for="iterationCount" class="form-label">Iteration count</label>
                    <input type="number" id="iterationCount" name="iterationCount" class="form-control" value="10000" required>
                  </div>
            
                  <div class="mb-3">
                    <label for="salt" class="form-label">Salt</label>
                    <div class="input-group">
                    <input type="text" id="salt" name="salt" class="form-control" value="KDV4ETAMVQB5FCEIXUKWT7V6ZFYVW7H5" required>
                    <button class="btn btn-outline-primary" onclick="generateWithMaster()">My Salt</button>
                    </div>
                  </div>
        
                </form>
                <div id="keyGeneratorAlertContainer" class="mt-3"></div>
                <button type="button" style="width: 100%; margin-bottom: 1%;" class="btn btn-primary" onclick="generateKey()">Create a [xX-7x] Password</button>
                <button type="button" style="width: 100%; margin-bottom: 1%;" class="btn btn-primary" onclick="generateLetterKey()">Create a [xXxX] Password</button>
                <button type="button" style="width: 100%; margin-bottom: 1%;" class="btn btn-primary" onclick="generateNumberKey()">Create a [7777] Password</button>
                <button type="button" style="width: 100%; margin-bottom: 1%;" class="btn btn-primary" onclick="generateSpecialKey()">Create a [!x%X>] Password</button>
        </div>
        <div class="col-md-6">

          <!-- Second column content goes here -->

            <h4 style="color: darkblue; margin-top: 1rem;">Salt Generator</h4>
            <input style="margin-bottom: 1rem;" type="text" class="form-control" id="result" readonly>
            <button class="btn btn-outline-primary" onclick="generate()">Generate Random Salt</button>
            <button class="btn btn-outline-secondary" onclick="copyToSalt()">Copy to Salt</button>
            <h6 id="usecase" style="color: lightgray; margin-top: 2rem; margin-bottom: 2rem;">Click here to read a use case</h6>
            <p id="explanation" style="display: none;">I want to log in to the site: https://quotes.toscrape.com/login, where I registered earlier with the password created with Carrypass.
                I type "Quotes" in  the Website name field, then I type my Master key "Password123", and click on the Standard button. 
                CarryPass creates and copies the password "7cgUK3I-oivkxzc-bmX9VR7" to the clipboard so I can paste it in the password field on the login page of "Quotes".
                As long as the parameters are the same I always get the same password, and while I do not have to remember its complexity, it stays private.
                In order to create a cryptographycally more secure password, I increase the Iteration count and use my own Salt. For some sites I generate a random salt that I keep secret.
            </p>
        </div>
      </div>
    </div>
  </section>

    <!-- Third Section -->
    <section id="encryption" class="third-section" style="background-image: url('saeed-karimi-JrrWC7Qcmhs-unsplash.jpg');">
        <div class="container">
        <div class="row">
            <div class="col-md-6">
            <h2>Keep your secret private</h2>
            <h2 style="margin-left: 9rem;">even if you share it</h2>
            <a href="#encrypt" style="margin-top: 9rem;" class="btn btn-danger">Encrypt</a>
            </div>
            <div class="col-md-6">
            <!-- Second column content goes here -->
            </div>
        </div>
        </div>
    </section>

      <!-- Fourth Section -->
    <section id="encrypt" class="fourth-section">
        <div class="container" style="margin-bottom: 9rem;">
        <div class="row">
            <div class="col-md-6">
                <h2 style="color: darkblue; margin-top: 3rem;">Encrypt</h2>
                <div id="encryptionAlertContainer" class="mt-3"></div>
                <form id="encryptionForm">
                  <div class="mb-3">
                    <label for="plaintext" class="form-label">Text to Encrypt:</label>
                    <textarea id="plaintext" name="plaintext" class="form-control" rows="6" required></textarea>
                  </div>
                  
                  <div class="mb-3">
                    <label for="encryptionPassword" class="form-label">Encryption Password:</label>
                    <input type="password" id="encryptionPassword" name="encryptionPassword" class="form-control" required>
                  </div>
            
                  <button type="button" class="btn btn-primary" onclick="encryptText()">Encrypt</button>
                  <button type="button" class="btn btn-outline-secondary" onclick="copyEncryptedText()">Copy Encrypted Text</button>
                </form>
            </div>
            <div class="col-md-6">
                <h2 style="color: darkblue; margin-top: 3rem;">Decrypt</h2>
                <div id="decryptionAlertContainer" class="mt-3"></div>
                <form id="decryptionForm">
                <div class="mb-3">
                    <label for="encryptedText" class="form-label">Encrypted Text:</label>
                    <textarea id="encryptedText" name="encryptedText" class="form-control" rows="6" required></textarea>
                </div>
                
                <div class="mb-3">
                    <label for="decryptionPassword" class="form-label">Decryption Password:</label>
                    <input type="password" id="decryptionPassword" name="decryptionPassword" class="form-control" required>
                </div>

                <button type="button" class="btn btn-primary" onclick="decryptText()">Decrypt</button>
                <button type="button" class="btn btn-outline-secondary" onclick="copyDecryptedText()">Copy Decrypted Text</button>
                </form>
            </div>
        </div>
        </div>
    </section>

        <!-- Third Section -->
      <section id="about" class="fourth-section">
          <div class="container">
          <div class="row">
              <div class="col-md-6">
              <h2></h2>
              <h2 style="margin-left: 9rem;"></h2>
              <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis ac hendrerit diam, sit amet pulvinar justo. Vivamus vitae magna at dolor pulvinar ultrices eget eu magna. Vivamus at placerat arcu. Pellentesque at lacus dolor. Cras tempor arcu quis diam bibendum sodales. Vivamus vitae odio porta, sagittis velit non, hendrerit quam. Pellentesque dapibus eu augue ac sagittis.

                Duis erat tortor, dictum ac vestibulum quis, auctor in eros. Ut massa neque, lobortis et varius eget, ultrices a justo. Donec nec enim ac justo imperdiet imperdiet. Fusce sed semper nisi. Pellentesque eu pharetra ante. Proin convallis urna non odio volutpat porta. Nam tincidunt metus vitae odio finibus placerat sed id augue. Aenean justo odio, vehicula ac metus vel, suscipit consequat neque. Curabitur ornare vitae mi in rhoncus. 
                Aenean eu quam a eros egestas pretium eu et enim. Nam sit amet ullamcorper quam, at lacinia arcu. Nulla ultricies, nibh a ultrices faucibus, libero quam mollis quam, ut mollis nisl nulla vel lectus. Aliquam dapibus est in elit accumsan faucibus.
                
                Sed vel fringilla tellus. Mauris aliquam tortor massa, sit amet congue ex pellentesque non. Suspendisse at erat metus. Nam luctus interdum rhoncus. Donec feugiat sapien ac dolor porttitor, at tincidunt nibh facilisis. Morbi commodo tincidunt varius. Suspendisse ultrices est vel lobortis placerat. Etiam placerat tincidunt vulputate. 
                Vivamus facilisis, risus cursus ornare finibus, nisi nibh vulputate dolor, a mollis velit libero ultrices mauris. Aenean at nisi nisl. Curabitur malesuada elit a lobortis auctor. Aliquam efficitur laoreet eros id viverra. Proin viverra volutpat nunc at vestibulum. Maecenas erat lorem, faucibus quis enim quis, convallis pretium risus. Donec vehicula, lacus quis placerat convallis, lacus eros ultricies nunc, eu pretium est dolor sed turpis. Phasellus fringilla purus felis.</p>
              </div>
              <div class="col-md-6">
              <!-- Second column content goes here -->
              </div>
          </div>
          </div>
      </section>

          <!-- Third Section -->
    <section id="pricing" class="third-section" style="background-image: url('morgan-housel-X_fbh4Utwk4-unsplash.jpg');">
      <div class="container">
      <div class="row">
          <div class="col-md-6">
          <h1 style="color:black;">CarryPass is free</h1>
          <h2 style="margin-left: 9rem;"></h2>
          </div>
          <div class="col-md-6">
            <h4 style="color: black; margin-bottom: 3rem;" class="section-text">Although CarryPass is free, it still has to be hosted and maintained, so every little support is appreciated. Thank you!</h2>
            <h4 class="section-text"><script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="zoltanracz" data-color="#5F7FFF" data-emoji=""  data-font="Bree" data-text="Buy me a coffee" data-outline-color="#000000" data-font-color="#ffffff" data-coffee-color="#FFDD00" ></script></h2>
          </div>
      </div>
      </div>
    </section>

  <!-- Fifth Section -->
  <section id="contact" class="fifth-section">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <h2>Contact</h2>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis vehicula est vitae elit pharetra, nec mollis ante feugiat.</p>
        </div>
        <div class="col-md-6">
          <!-- Second column content goes here -->
        </div>
      </div>
    </div>
  </section>

    <!-- Spinner Modal -->
    <div class="modal" id="spinnerModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-body text-center">
              <div class="spinner-border text-success" role="status">
                <span class="sr-only">Loading...</span>
              </div>
            </div>
          </div>
        </div>
    </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <span class="text-muted">CarryPass© 2022 : Rácz Zoltán : zoltan@carrypass.net</span>
    </div>
  </footer>

  <!-- Scroll to Top Button -->
  <a id="scroll-up" href="#home" type="button" class="btn-scroll-up"><i class="fas fa-chevron-up"></i></a>

  <!-- <script src="https://kit.fontawesome.com/a076d05399.js"></script> -->
  <script src="jquery-3.5.1.min.js"></script>
  <script src="bootstrap.bundle.min.js"></script>
  <script>
    // Smooth Scrolling Effect
    $(document).ready(function() {
      $('a[href^="#"]').on('click', function(event) {
        var target = $(this.getAttribute('href'));
        if (target.length) {
          event.preventDefault();
          $('html, body').stop().animate({
            scrollTop: target.offset().top - $('.navbar').outerHeight() // Offset to adjust for navbar height
          }, 1000);
        }
      });
    });

    // Scroll to Top Button
    $(document).ready(function(){
      $(window).scroll(function(){
        if ($(this).scrollTop() > 100) {
          $('#scroll-up').fadeIn();
        } else {
          $('#scroll-up').fadeOut();
        }
      });
      $('#scroll-up').click(function(){
        $("html, body").animate({ scrollTop: 0 }, 600);
        return false;
      });
    });

    $(document).ready(function(){
    console.log("Document ready!");
    
    $(window).scroll(function(){
        console.log("Scroll event!");
        // Add more debug logs as needed
    });

    $('#scroll-up').click(function(){
        console.log("Button clicked!");
        // Add more debug logs as needed
    });
});

  </script>
    <script>
        // Function to generate a simple CAPTCHA code
        function generateRandomPasswordKey(webAddress, password, iterationCount, salt, length) {
          let inputStr = webAddress + password;
          // let combinedStr = inputStr + salt;
    
          let iterations = iterationCount;
          let hashBytes = CryptoJS.PBKDF2(inputStr, salt, { keySize: length/4, iterations: iterations, hasher: CryptoJS.algo.SHA256 });
    
          let encodedString = bytesToAlphaNumericString(hashBytes);
          let key = '';
    
          let fullSegments = Math.floor(length / 7);
          let remainder = length % 7;

          for (let i = 0; i < fullSegments; i++) {
            key += encodedString.slice(i * 7, (i + 1) * 7) + '-';
          }
    
          if (remainder > 0) {
            key += encodedString.slice(fullSegments * 7, fullSegments * 7 + remainder);
          } else {
            key = key.slice(0, -1);
          }
    
          return key;
        }

        function generateRandomLetterKey(webAddress, password, iterationCount, salt, length) {
          let inputStr = webAddress + password;
          // let combinedStr = inputStr + salt;
    
          let iterations = iterationCount;
          let hashBytes = CryptoJS.PBKDF2(inputStr, salt, { keySize: length/4, iterations: iterations, hasher: CryptoJS.algo.SHA256 });
    
          let encodedString = bytesToAlphaString(hashBytes);
          let key = '';
    
          let fullSegments = Math.floor(length / 7);
          let remainder = length % 7;

          for (let i = 0; i < fullSegments; i++) {
            key += encodedString.slice(i * 7, (i + 1) * 7) + '';
          }
    
          if (remainder > 0) {
            key += encodedString.slice(fullSegments * 7, fullSegments * 7 + remainder);
          } else {
            key = key.slice(0, -1);
          }
    
          return key;
        }

        function generateRandomNumberKey(webAddress, password, iterationCount, salt, length) {
          let inputStr = webAddress + password;
          // let combinedStr = inputStr + salt;
    
          let iterations = iterationCount;
          let hashBytes = CryptoJS.PBKDF2(inputStr, salt, { keySize: length/4, iterations: iterations, hasher: CryptoJS.algo.SHA256 });
    
          let encodedString = bytesToNumericString(hashBytes);
          let key = '';
    
          let fullSegments = Math.floor(length / 7);
          let remainder = length % 7;

          for (let i = 0; i < fullSegments; i++) {
            key += encodedString.slice(i * 7, (i + 1) * 7) + '';
          }
    
          if (remainder > 0) {
            key += encodedString.slice(fullSegments * 7, fullSegments * 7 + remainder);
          } else {
            key = key.slice(0, -1);
          }
    
          return key;
        }


        function generateRandomMixedKey(webAddress, password, iterationCount, salt, length) {
          let inputStr = webAddress + password;
          // let combinedStr = inputStr + salt;
    
          let iterations = iterationCount;
          let hashBytes = CryptoJS.PBKDF2(inputStr, salt, { keySize: length/4, iterations: iterations, hasher: CryptoJS.algo.SHA256 });
    
          let encodedString = bytesToAlphaNumericString(hashBytes);
          let key = '';
    
          let fullSegments = Math.floor(length / 7);
          let remainder = length % 7;

          for (let i = 0; i < fullSegments; i++) {
            key += encodedString.slice(i * 7, (i + 1) * 7) + '';
          }
    
          if (remainder > 0) {
            key += encodedString.slice(fullSegments * 7, fullSegments * 7 + remainder);
          } else {
            key = key.slice(0, -1);
          }
    
          return key;
        }

    
        function generateRandomSpecialKey(webAddress, password, iterationCount, salt, length) {
          let inputStr = webAddress + password;
          // let combinedStr = inputStr + salt;
    
          let iterations = iterationCount;
          let hashBytes = CryptoJS.PBKDF2(inputStr, salt, { keySize: length/4, iterations: iterations, hasher: CryptoJS.algo.SHA256 });
    
          let encodedString = bytesToMoreSpecialString(hashBytes);
          let key = '';
    
          let fullSegments = Math.floor(length / 7);
          let remainder = length % 7;

          for (let i = 0; i < fullSegments; i++) {
            key += encodedString.slice(i * 7, (i + 1) * 7) + '';
          }
    
          if (remainder > 0) {
            key += encodedString.slice(fullSegments * 7, fullSegments * 7 + remainder);
          } else {
            key = key.slice(0, -1);
          }
    
          return key;
        }
    
    
    function bytesToAlphaNumericString(bytes) {
      let charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let result = '';
      let hasLowercase = false;
      let hasUppercase = false;
      let hasDigit = false;
    
      for (let i = 0; i < bytes.words.length * 4; i++) {
        let byte = (bytes.words[Math.floor(i / 4)] >> (24 - (i % 4) * 8)) & 0xff;
        let char = charset.charAt(byte % charset.length);
    
        // Check if the character is lowercase, uppercase, or a digit
        if (!hasLowercase && /[a-z]/.test(char)) {
          hasLowercase = true;
        } else if (!hasUppercase && /[A-Z]/.test(char)) {
          hasUppercase = true;
        } else if (!hasDigit && /[0-9]/.test(char)) {
          hasDigit = true;
        }
    
        result += char;
      }
    
      // Ensure that the generated string contains at least one lowercase, one uppercase, and one digit
      if (!(hasLowercase && hasUppercase && hasDigit)) {
        // Regenerate the string if any of the required characters is missing
        return bytesToAlphaNumericString(bytes);
      }
    
      return result;
    }
    
    function bytesToAlphaString(bytes) {
      let charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
      let result = '';
      let hasLowercase = false;
      let hasUppercase = false;
    
      for (let i = 0; i < bytes.words.length * 4; i++) {
        let byte = (bytes.words[Math.floor(i / 4)] >> (24 - (i % 4) * 8)) & 0xff;
        let char = charset.charAt(byte % charset.length);
    
        // Check if the character is lowercase, uppercase, or a digit
        if (!hasLowercase && /[a-z]/.test(char)) {
          hasLowercase = true;
        } else if (!hasUppercase && /[A-Z]/.test(char)) {
          hasUppercase = true;
        }
    
        result += char;
      }
    
      // Ensure that the generated string contains at least one lowercase, one uppercase, and one digit
      if (!(hasLowercase && hasUppercase)) {
        // Regenerate the string if any of the required characters is missing
        return bytesToAlphaString(bytes);
      }
    
      return result;
    }

    
    function bytesToMoreSpecialString(bytes) {
      let charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()-_=+[]{}|;:,.<>?';
      let result = '';
      let hasLowercase = false;
      let hasUppercase = false;
      let hasDigit = false;
      let hasPunctuation = false;
    
      for (let i = 0; i < bytes.words.length * 4; i++) {
        let byte = (bytes.words[Math.floor(i / 4)] >> (24 - (i % 4) * 8)) & 0xff;
        let char = charset.charAt(byte % charset.length);
    
        // Check if the character is lowercase, uppercase, or a digit
        if (!hasLowercase && /[a-z]/.test(char)) {
          hasLowercase = true;
        } else if (!hasUppercase && /[A-Z]/.test(char)) {
          hasUppercase = true;
        } else if (!hasDigit && /[0-9]/.test(char)) {
          hasDigit = true;
        } else if (!hasPunctuation && /[!@#$%^&*()-_=+[\]{}|;:,.<>?]/.test(char)) {
          hasPunctuation = true;
        }
    
        result += char;
      }
    
      // Ensure that the generated string contains at least one lowercase, one uppercase, and one digit
      if (!(hasLowercase && hasUppercase && hasDigit && hasPunctuation)) {
        // Regenerate the string if any of the required characters is missing
        return bytesToMoreSpecialString(bytes);
      }
    
      return result;
    }
    
    function bytesToNumericString(bytes) {
      let charset = '0123456789';
      let result = '';
    
    
      for (let i = 0; i < bytes.words.length * 4; i++) {
        let byte = (bytes.words[Math.floor(i / 4)] >> (24 - (i % 4) * 8)) & 0xff;
        let char = charset.charAt(byte % charset.length);
    
        result += char;
      }
      return result;
    }
    
    
        function generateKey() {
          let webAddress = document.getElementById("webAddress").value;
          let password = document.getElementById("password").value;
          let iterationCount = document.getElementById("iterationCount").value;
          let salt = document.getElementById("salt").value;
          let length = document.getElementById("length").value;
    
          let key = generateRandomPasswordKey(webAddress, password, iterationCount, salt, length);
    
          copyToClipboard(key);
    
          document.getElementById("webAddress").value = "";
          document.getElementById("password").value = "";
          document.getElementById("iterationCount").value = "10000";
          document.getElementById("salt").value = "KDV4ETAMVQB5FCEIXUKWT7V6ZFYVW7H5";
          document.getElementById("length").value = "21";
    
          showAlert("Password copied to clipboard.", "success", document.getElementById("keyGeneratorAlertContainer"));
        }

        function generateLetterKey() {
          let webAddress = document.getElementById("webAddress").value;
          let password = document.getElementById("password").value;
          let iterationCount = document.getElementById("iterationCount").value;
          let salt = document.getElementById("salt").value;
          let length = document.getElementById("length").value;
    
          let key = generateRandomLetterKey(webAddress, password, iterationCount, salt, length);
    
          copyToClipboard(key);
    
          document.getElementById("webAddress").value = "";
          document.getElementById("password").value = "";
          document.getElementById("iterationCount").value = "10000";
          document.getElementById("salt").value = "KDV4ETAMVQB5FCEIXUKWT7V6ZFYVW7H5";
          document.getElementById("length").value = "21";
    
          showAlert("Password copied to clipboard.", "success", document.getElementById("keyGeneratorAlertContainer"));
        }

        function generateNumberKey() {
          let webAddress = document.getElementById("webAddress").value;
          let password = document.getElementById("password").value;
          let iterationCount = document.getElementById("iterationCount").value;
          let salt = document.getElementById("salt").value;
          let length = document.getElementById("length").value;
    
          let key = generateRandomNumberKey(webAddress, password, iterationCount, salt, length);
    
          copyToClipboard(key);
    
          document.getElementById("webAddress").value = "";
          document.getElementById("password").value = "";
          document.getElementById("iterationCount").value = "10000";
          document.getElementById("salt").value = "KDV4ETAMVQB5FCEIXUKWT7V6ZFYVW7H5";
          document.getElementById("length").value = "21";
    
          showAlert("Password copied to clipboard.", "success", document.getElementById("keyGeneratorAlertContainer"));
        }

        function generateMixedKey() {
          let webAddress = document.getElementById("webAddress").value;
          let password = document.getElementById("password").value;
          let iterationCount = document.getElementById("iterationCount").value;
          let salt = document.getElementById("salt").value;
          let length = document.getElementById("length").value;
    
          let key = generateRandomMixedKey(webAddress, password, iterationCount, salt, length);
    
          copyToClipboard(key);
    
          document.getElementById("webAddress").value = "";
          document.getElementById("password").value = "";
          document.getElementById("iterationCount").value = "10000";
          document.getElementById("salt").value = "KDV4ETAMVQB5FCEIXUKWT7V6ZFYVW7H5";
          document.getElementById("length").value = "21";
    
          showAlert("Password copied to clipboard.", "success", document.getElementById("keyGeneratorAlertContainer"));
        }
    
        function generateSpecialKey() {
          let webAddress = document.getElementById("webAddress").value;
          let password = document.getElementById("password").value;
          let iterationCount = document.getElementById("iterationCount").value;
          let salt = document.getElementById("salt").value;
          let length = document.getElementById("length").value;
    
          let key = generateRandomSpecialKey(webAddress, password, iterationCount, salt, length);
    
          copyToClipboard(key);
    
          document.getElementById("webAddress").value = "";
          document.getElementById("password").value = "";
          document.getElementById("iterationCount").value = "10000";
          document.getElementById("salt").value = "KDV4ETAMVQB5FCEIXUKWT7V6ZFYVW7H5";
          document.getElementById("length").value = "21";
    
          showAlert("Password copied to clipboard.", "success", document.getElementById("keyGeneratorAlertContainer"));
        }
    
        function encryptText() {
          let plaintext = document.getElementById("plaintext").value;
          let encryptionPassword = document.getElementById("encryptionPassword").value;
    
          let encrypted = CryptoJS.AES.encrypt(plaintext, encryptionPassword).toString();
          document.getElementById("encryptedText").value = encrypted;
          showAlert("Text encrypted successfully.", "success", document.getElementById("encryptionAlertContainer"));
        }
    
        function copyEncryptedText() {
          let encryptedText = document.getElementById("encryptedText").value;
          copyToClipboard(encryptedText);
          showAlert("Encrypted text copied to clipboard.", "success", document.getElementById("encryptionAlertContainer"));
        }
    
        function decryptText() {
            let encryptedText = document.getElementById("encryptedText").value;
            let decryptionPassword = document.getElementById("decryptionPassword").value;
            let alertContainer = document.getElementById("decryptionAlertContainer");
            
            try {
                let decrypted = CryptoJS.AES.decrypt(encryptedText, decryptionPassword).toString(CryptoJS.enc.Utf8);
                if (decrypted) {
                document.getElementById("plaintext").value = decrypted;
                showAlert("Text decrypted successfully.", "success", alertContainer);
                } else {
                showAlert("Decryption failed: incorrect password.", "danger", alertContainer);
                }
            } catch (error) {
                showAlert("Decryption failed. Please check your password and try again.", "danger", alertContainer);
            }
        }
    
    
        function copyDecryptedText() {
          let plaintext = document.getElementById("plaintext").value;
          copyToClipboard(plaintext);
          showAlert("Decrypted text copied to clipboard.", "alert-success", document.getElementById("decryptionAlertContainer"));
        }
    
        function copyToClipboard(text) {
          let input = document.createElement('textarea');
          input.value = text;
          document.body.appendChild(input);
          input.select();
          document.execCommand('copy');
          document.body.removeChild(input);
        }
    
        function showAlert(message, alertType, container) {
            let alertElement = document.createElement("div");
            alertElement.className = "alert alert-" + alertType + " alert-dismissible fade show";
            alertElement.role = "alert";
            alertElement.innerHTML = `
                ${message}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
            `;
            container.prepend(alertElement);

            setTimeout(function() {
                $(alertElement).alert('close');
            }, 3000);
        }

      </script>
      <script>

    function generate() {
          var base32Chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'; // Base32 characters
          var randomValues = new Uint8Array(40); // 20 bytes for 32 characters
          window.crypto.getRandomValues(randomValues);
          
          var result = '';
          for (var i = 0; i < 32; i++) {
            result += base32Chars.charAt(randomValues[i] % 32);
          }
          document.getElementById('result').value = result;
    }

    function generateWithMaster() {
      var input = document.getElementById('password').value;
      var base32Chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'; // Base32 characters
      
      // Ensure input is at least 32 characters long
      if (input != "") {
      while (input.length < 32) {
        input += input; // Concatenate input with itself until it's at least 32 characters long
      }
      input = input.slice(0, 32); // Trim to 32 characters
      }
      else {
        alert("Master key input field cannot be empty.")
      }
      
      // Convert input to base64
      var base64 = btoa(input);

      // Convert base64 to base32
      var result = '';
      for (var i = 0; i < base64.length; i++) {
        var char = base64.charAt(i);
        if (char !== '=') {
          var index = char.charCodeAt(0);
          if (index === 43) index = 62; // Convert '+' to base64 index
          else if (index === 47) index = 63; // Convert '/' to base64 index
          result += base32Chars[index >> 2]; // First 5 bits
          result += base32Chars[((index & 0x03) << 3) | (base64.charCodeAt(++i) >> 5)]; // Next 3 bits from current and first 2 bits from next
          result += base32Chars[base64.charCodeAt(i) & 0x1F]; // Last 5 bits
        }
      }

      // Truncate result to 32 characters
      result = result.slice(0, 32);

      document.getElementById('salt').value = result;

      document.getElementById('keyGeneratorForm').addEventListener('submit', function(event) {
      // Prevent the form from submitting
      event.preventDefault();
      
      });

    }

    function copyToSalt() {
        var resultInput = document.getElementById('result');
        var saltinput = document.getElementById('salt');
        saltinput.value = resultInput.value;
    }


    function showMaster() {
        var passwordinput = document.getElementById('password');
        var showbutton = document.getElementById('showbutton');
        if (passwordinput.type == "password"){
          showbutton.innerHTML = "Hide";
          passwordinput.setAttribute('type', 'text');
        }
        else {
          showbutton.innerHTML = "Show";
          passwordinput.setAttribute('type', 'password');
        }
    }
    
    
      </script>

<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
      navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
      }, function(err) {
        console.error('ServiceWorker registration failed: ', err);
      });
    });
  }

  document.getElementById('downloadButton').addEventListener('click', function() {
    if ('serviceWorker' in navigator && 'caches' in window) {
      // Ask for permission
      if (confirm('Do you want to download resources for offline use?')) {
        // Cache resources
        caches.open('key-generator-cache-v1').then(function(cache) {
          cache.addAll([
            '/',
            'bootstrap.min.css',
            'jquery.min.js',
            'crypto-js.min.js',
            // Add more files you want to cache here
          ]).then(function() {
            alert('Resources downloaded successfully for offline use.');
          }).catch(function(error) {
            console.error('Cache error:', error);
          });
        });
      }
    } else {
      alert('Offline functionality is not supported on this browser.');
    }
  });
</script>
<script>
  document.getElementById('usecase').addEventListener('click', function() {
    var explanation = document.getElementById('explanation');
    if (explanation.style.display === 'none') {
      explanation.style.display = 'block';
    } else {
      explanation.style.display = 'none';
    }
  });
  </script>
</body>
</html>
